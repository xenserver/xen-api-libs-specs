# -*- rpm-spec -*-

Summary: command-line tools for manipulating and streaming .vhd format files
Name:    vhd-tool
Version: @VERSION@
Release: 1
Group:   System/Hypervisor
License: LGPL+linking exception
URL:     https://github.com/djs55/vhd-tool/archive/vhd-tool-%{version}.tar.gz
Source0: git:///repos/vhd-tool
Source1: vhd-tool-sparse_dd-conf
BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}
BuildRequires: ocaml ocaml-findlib ocaml-camlp4-devel ocaml-ocamldoc
BuildRequires: ocaml-xcp-idl-devel ocaml-vhd-devel ocaml-obuild
BuildRequires: ocaml-nbd-devel ocaml-cstruct-devel ocaml-lwt-devel
BuildRequires: ocaml-ounit-devel ocaml-rpc-devel ocaml-ssl-devel ocaml-stdext-devel
BuildRequires: ocaml-tapctl-devel ocaml-xen-lowlevel-libs-devel
BuildRequires: ocaml-xenstore-devel cmdliner-devel ocaml-oclock-devel
BuildRequires: ocaml-xenstore-clients-devel message-switch-devel
BuildRequires: openssl openssl-devel

%description
Simple command-line tools for manipulating and streaming .vhd format file.

%prep 
%setup -q -n %{name}-%{version}


%build
./configure --bindir %{buildroot}/%{_bindir} --libexecdir %{buildroot}/%{_libexecdir} --etcdir %{buildroot}/etc
make

%install
rm -rf %{buildroot}
 
mkdir -p %{buildroot}/%{_libexecdir}
mkdir -p %{buildroot}/etc
make install

%clean
rm -rf %{buildroot}

%files
%defattr(-,root,root,-)
/etc/sparse_dd.conf
%{_libexecdir}/vhd-tool
%{_libexecdir}/sparse_dd

%changelog
* Wed Oct 02 2013 David Scott <dave.scott@eu.citrix.com> - 0.6.0-1
- Update to 0.6.0

* Fri Sep 27 2013 David Scott <dave.scott@eu.citrix.com> - 0.5.1-1
- Update to 0.5.1

* Mon Sep 23 2013 David Scott <dave.scott@eu.citrix.com> - 0.5.0-1
- Initial package
